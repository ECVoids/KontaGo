<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Inventario</title>
    <style>
  /* ===== Base ===== */
  body{
    font-family: Arial, sans-serif;
    background:#f5f0e6;
    margin:0; padding:20px;
    color:#3e2723;
  }
  h1{ text-align:center; color:#4b2e2e; margin-bottom:20px; }

  /* ===== Botones generales ===== */
  .btn-entry{
    display:inline-block; margin:0 0 20px 178px;
    background:#a97155; color:#fff; padding:10px 18px;
    border-radius:8px; text-decoration:none; font:700 14px/1 Arial;
    transition:background .2s;
  }
  .btn-entry:hover{ background:#8b5e3c; }

  .btn-home{
    display:block; width:fit-content; margin:30px auto 0; padding:12px 20px;
    background:#4b2e2e; color:#fff; text-decoration:none; border-radius:8px; font-size:16px;
    transition:background .2s;
  }
  .btn-home:hover{ background:#3e2723; }

  /* ===== Mensajes ===== */
  .messages-container{ max-width:600px; margin:0 auto 20px; }
  .message{ padding:12px; margin-bottom:10px; border-radius:8px; font:700 15px/1 Arial; }
  .message.success{ background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
  .message.error  { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
  .message.warning{ background:#fff3cd; color:#856404; border:1px solid #ffeeba; }

  /* ===== Filtros ===== */
  .filters-form{
    max-width:1200px; margin:16px auto 22px;
    background:#f7efe2; border:1px solid #e8dcca; border-radius:14px;
    padding:16px;
  }
  .filters-grid{
    display:grid; gap:14px; align-items:end;
    grid-template-columns:repeat(12, minmax(0,1fr));
  }
  /* Fila 1: buscador (8) + categorÃ­a (4) */
  .f-wide{ grid-column:span 8; }
  /* Fila 2: proveedor (4) + mÃ­n (4) + mÃ¡x (4) */
  .f-item{ grid-column:span 4; }
  /* Fila 3: acciones */
  .f-actions{ grid-column:1 / -1; display:flex; gap:12px; justify-content:center; }

  .label{ display:block; margin:0 0 6px; font:700 13px/1 Arial; color:#4b2e2e; }
  .input,.select{
    width:100%; height:44px; padding:0 12px;
    border:1.5px solid #d9c7a6; border-radius:12px;
    background:#fffaf3; color:#3e2723; font-size:14px;
    outline:none; transition:border-color .2s, box-shadow .2s, background .2s;
  }
  .input::placeholder{ color:#9b8b7a; }
  .input:focus,.select:focus{
    border-color:#a97155; box-shadow:0 0 0 3px rgba(169,113,85,.18); background:#fff;
  }
  .select{
    appearance:none; -webkit-appearance:none; -moz-appearance:none; padding-right:36px;
    background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='%238b5e3c'><path d='M7 10l5 5 5-5z'/></svg>");
    background-repeat:no-repeat; background-position:right 10px center;
  }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
  input[type="number"]{ -moz-appearance:textfield; }

  .btn-search{
    min-height:44px; padding:0 18px;
    border:none; border-radius:12px; background:#a97155; color:#fff; font:800 14px/1 Arial;
    cursor:pointer; transition:transform .06s, filter .2s;
  }
  .btn-search:hover{ filter:brightness(.96); }
  .btn-search:active{ transform:translateY(1px); }

  .link-clear{
    font:800 14px/1 Arial; color:#a97155; text-decoration:none; padding:10px 12px; border-radius:10px;
    transition:color .2s, background .2s;
  }
  .link-clear:hover{ color:#4b2e2e; background:rgba(169,113,85,.12); }

  /* ===== Grid de productos ===== */
  .inventory-container{
    display:grid; grid-template-columns:repeat(auto-fit, minmax(280px,1fr));
    gap:20px; max-width:1200px; margin:0 auto;
  }
  .card{
    background:#fffaf3; border:1px solid #d9c7a6; border-radius:12px; padding:20px;
    box-shadow:2px 4px 6px rgba(0,0,0,.1); text-align:center; transition:transform .2s;
  }
  .card:hover{ transform:translateY(-5px); }
  .card img{ width:100%; max-height:200px; object-fit:cover; border-radius:8px; margin-bottom:15px; }
  .card h2{ font-size:22px; margin:0 0 10px; }
  .card p{ margin:6px 0; font-size:15px; color:#4e342e; }
  .card p strong{ color:#3e2723; }
  .btn{ display:block; width:100%; padding:12px; margin-top:10px; font:700 15px/1 Arial; border:none; border-radius:8px; cursor:pointer; }
  .btn-add{ background:#6d4c41; color:#fff; } .btn-add:hover{ background:#5d4037; }
  .btn-delete{ background:#8d3c2b; color:#fff; } .btn-delete:hover{ background:#6e2c1a; }

  /* ===== PaginaciÃ³n ===== */
  .pagination{ margin:16px auto; display:flex; gap:12px; justify-content:center; align-items:center; }

  /* ===== Responsive ===== */
  @media (max-width:900px){
    .f-wide{ grid-column:span 12; }
    .f-item{ grid-column:span 6; }
    .f-actions{ grid-column:span 12; }
  }
  @media (max-width:560px){
    .f-item, .f-wide, .f-actions{ grid-column:span 12; }
  }

  </style>


</head>
<body>
    <h1>Product Inventory</h1>

    <!-- BotÃ³n Product Entry con margen -->
    <a href="{% url 'product_entry' %}" class="btn-entry">âž• Product Entry</a>

    <a href="{% url 'inventory_pdf' %}{% if request.GET %}?{{ request.GET.urlencode }}{% endif %}"
   class="btn-entry" style="margin-left:12px;background:#6d4c41;">
  ðŸ“„ Exportar PDF
    </a>


    <!-- Bloque de mensajes -->
    {% if messages %}
    <div class="messages-container">
        {% for message in messages %}
            <div class="message {{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
    {% endif %}

    <form method="get" class="filters-form">
  <div class="filters-grid">
    <!-- FILA 1: buscador (8/12) + categorÃ­a (4/12) -->
    <div class="f-item" style="grid-column: 1 / span 7;">
      <input
        type="text" name="q" class="input"
        placeholder="Buscar por nombre, descripciÃ³n, categorÃ­a o proveedorâ€¦"
        value="{{ filters.q }}" aria-label="Buscar">
    </div>

    <div class="f-item" style="grid-column: 9 / span 4;">
      <label class="label">CategorÃ­a</label>
      <select name="category" class="select">
        <option value="">Todas</option>
        {% for c in categories %}
          <option value="{{ c }}" {% if filters.category == c %}selected{% endif %}>{{ c|title }}</option>
        {% endfor %}
      </select>
    </div>

    <!-- FILA 2: proveedor (4/12) + precio mÃ­n (4/12) + precio mÃ¡x (4/12) -->
    <div class="f-item" style="grid-column: 1 / span 4;">
      <label class="label">Proveedor</label>
      <select name="supplier" class="select">
        <option value="">Todos</option>
        {% for s in suppliers %}
          <option value="{{ s }}" {% if filters.supplier == s %}selected{% endif %}>{{ s }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="f-item" style="grid-column: 5 / span 3;">
      <label class="label">Precio mÃ­n</label>
      <input type="number" step="0.01" name="min_price" class="input" value="{{ filters.min_price }}">
    </div>

    <div class="f-item" style="grid-column: 9 / span 3;">
      <label class="label">Precio mÃ¡x</label>
      <input type="number" step="0.01" name="max_price" class="input" value="{{ filters.max_price }}">
    </div>

    <!-- FILA 3: acciones toda la fila -->
    <div class="f-actions" style="grid-column: 1 / -1; justify-content: center;">
      <button type="submit" class="btn-search">ðŸ”Ž Buscar</button>
      <a href="{% url 'inventory_display' %}" class="link-clear">Limpiar</a>
    </div>
  </div>
</form>

     <div class="inventory-container">
        {% for product in products %}
        <div class="card">
            {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}">
            {% endif %}
            <h2>{{ product.name }}</h2>
            <p><strong>Category:</strong> {{ product.get_category_display }}</p>

            {% if product.expiration_date %}
                <p><strong>Expiration Date:</strong> {{ product.expiration_date }}</p>
            {% endif %}

            <p><strong>Supplier:</strong> {{ product.supplier }}</p>
            <p><strong>Price:</strong> ${{ product.price }}</p>
            <p><strong>Stock:</strong> {{ product.quantity }}</p>
            <p><strong>Description:</strong> {{ product.description }}</p>

            <a href="{% url 'add_unit' product.id %}" class="btn btn-add">âž• Add a new unit</a>

            <a href="{% url 'delete_product' product.id %}" 
               class="btn btn-delete"
               onclick="return confirm('Â¿Seguro que quieres eliminar {{ product.name }}?');">
                ðŸ—‘ Delete product
            </a>
        </div>
        {% empty %}
        <p style="text-align:center; color:#6d4c41;">No hay productos en el inventario.</p>
        {% endfor %}
    </div>
    <!-- BotÃ³n Back to Home abajo -->
    <a href="{% url 'home' %}" class="btn-home">â¬… Back to Home</a>
</body>
</html>
